---
assignee: Brett Jia
created: '2026-02-04T14:33:37.788602+00:00'
deps:
- bg-23b639
- bg-69a8a3
id: bg-7c06a6
parent: bg-92325e
priority: 1
status: closed
tags:
- offline
- commands
title: Add --offline flag to init command
type: task
updated: '2026-02-05T20:28:01.264037+00:00'
---

## Description

Update src/bodega/commands/init.py to support offline mode initialization:

## Add new options (after line 16)
```python
@click.option("--offline", is_flag=True, help="Initialize offline store in ~/.bodega/<project>/")
@click.option("--name", type=str, default=None, help="Custom name for offline store (used with --offline)")
```

## Update function signature (line 20)
Add `offline: bool` and `name: str | None` parameters

## Implementation logic
1. Validate flags:
   - If `--offline` and `--branch` both set → Error: "Cannot use --offline with --branch"
   - If `--name` without `--offline` → Warning: "--name ignored without --offline"

2. When `--offline` is True:
   - Get project identifier (use `name` if provided, else auto-detect)
   - Create ~/.bodega/<identifier>/ directory
   - Call init_repository(~/.bodega/<identifier>/)
   - Update global mapping via set_offline_store_mapping()
   - Print clear message about offline mode
   
3. Update docstring with offline examples

## Files to reference
- src/bodega/utils.py: get_project_identifier()
- src/bodega/config.py: set_offline_store_mapping()

## Notes

- 2026-02-05 20:23: Fixed custom name lookup issue: Updated both init.py and find_offline_store() to properly map auto-generated identifiers to custom names. Now stores mapping as {auto_identifier: custom_name} so lookup by identifier works correctly.